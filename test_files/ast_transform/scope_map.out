[{attribute,{loc,[],0,0},module,scope_map},
 {function,
     {loc,[],0,0},
     foo,1,
     [{fun_clause,
          {loc,[],0,0},
          [{var,{loc,[],0,0},{local_bind,{'X',0}}}],
          [],
          [{'case',
               {loc,[],0,0},
               {map_create,
                   {loc,[],0,0},
                   [{map_field_opt,
                        {loc,[],0,0},
                        {block,
                            {loc,[],0,0},
                            [{'case',
                                 {loc,[],0,0},
                                 {var,{loc,[],0,0},{local_ref,{'X',0}}},
                                 [{case_clause,{loc,[],0,0},{var,{loc,[],0,0},{local_bind,{'Z',0}}},[],[{var,{loc,[],0,0},{local_ref,{'Z',0}}}]}]}]},
                        {block,
                            {loc,[],0,0},
                            [{'case',
                                 {loc,[],0,0},
                                 {integer,{loc,[],0,0},3},
                                 [{case_clause,
                                      {loc,[],0,0},
                                      {var,{loc,[],0,0},{local_bind,{'Y',0}}},
                                      [],
                                      [{'case',
                                           {loc,[],0,0},
                                           {integer,{loc,[],0,0},1},
                                           [{case_clause,
                                                {loc,[],0,0},
                                                {var,{loc,[],0,0},{local_ref,{'Z',0}}},
                                                [],
                                                [{tuple,{loc,[],0,0},[{var,{loc,[],0,0},{local_ref,{'Y',0}}},{var,{loc,[],0,0},{local_ref,{'Z',0}}}]}]}]}]}]}]}}]},
               [{case_clause,
                    {loc,[],0,0},
                    {var,{loc,[],0,0},{local_bind,{'M',0}}},
                    [],
                    [{'case',
                         {loc,[],0,0},
                         {map_update,
                             {loc,[],0,0},
                             {block,
                                 {loc,[],0,0},
                                 [{'case',{loc,[],0,0},{integer,{loc,[],0,0},2},[{case_clause,{loc,[],0,0},{var,{loc,[],0,0},{local_bind,{'A',0}}},[],[{var,{loc,[],0,0},{local_ref,{'M',0}}}]}]}]},
                             [{map_field_opt,
                                  {loc,[],0,0},
                                  {block,
                                      {loc,[],0,0},
                                      [{'case',
                                           {loc,[],0,0},
                                           {integer,{loc,[],0,0},3},
                                           [{case_clause,
                                                {loc,[],0,0},
                                                {var,{loc,[],0,0},{local_bind,{'B',0}}},
                                                [],
                                                [{'case',
                                                     {loc,[],0,0},
                                                     {integer,{loc,[],0,0},2},
                                                     [{case_clause,{loc,[],0,0},{var,{loc,[],0,0},{local_ref,{'A',0}}},[],[{var,{loc,[],0,0},{local_ref,{'X',0}}}]}]}]}]}]},
                                  {integer,{loc,[],0,0},1}}]},
                         [{case_clause,
                              {loc,[],0,0},
                              {wildcard,{loc,[],0,0}},
                              [],
                              [{tuple,
                                   {loc,[],0,0},
                                   [{var,{loc,[],0,0},{local_ref,{'Y',0}}},
                                    {var,{loc,[],0,0},{local_ref,{'Z',0}}},
                                    {var,{loc,[],0,0},{local_ref,{'A',0}}},
                                    {var,{loc,[],0,0},{local_ref,{'B',0}}}]}]}]}]}]}]}]}].
